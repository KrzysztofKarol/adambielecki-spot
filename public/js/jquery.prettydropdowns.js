!function(a){a.fn.prettyDropdown=function(b){b=a.extend({customClass:"arrow",height:40,hoverIntent:100},b);var c,d,e,g,f=["0","1","2","3","4","5","6","7","8","9",,,,,,,,"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],h=function(h){var n,j=a(".prettydropdown > ul.active"),l=j.height()/(b.height-2),m=l%1<.5?Math.floor(l):Math.ceil(l);if(j.length){switch(h.preventDefault(),h.stopPropagation(),c=j.children("li.hover").index(),d=j.children().length-1,g=j.children().eq(c),j.data("lastKeypress",+new Date),h.which){case 13:return void g.click();case 27:return void i(j[0]);case 32:n=" ";break;case 33:return k(g,0),void k(j.children().eq(Math.max(c-m-1,0)),1);case 34:return k(g,0),void k(j.children().eq(Math.min(c+m-1,d)),1);case 35:return k(g,0),void k(j.children().eq(d),1);case 36:return k(g,0),void k(j.children().eq(0),1);case 38:return k(g,0),void k(c?j.children().eq(c-1):j.children().eq(d),1);case 40:return k(g,0),void k(c===d?j.children().eq(0):j.children().eq(c+1),1);default:n=f[h.which-48]}n&&(clearTimeout(e),j.data("keysPressed",void 0===j.data("keysPressed")?n:j.data("keysPressed")+n),e=setTimeout(function(){j.removeData("keysPressed")},300),j.children().each(function(){if(this===g[0])return!0;var b=a(this);return 0===b.text().toLowerCase().indexOf(j.data("keysPressed"))?(k(j.children(),0),k(b,1),!1):void 0}))}},i=function(c){var d=a(c.currentTarget||c);d.data("hover",!1),clearTimeout(e),e=setTimeout(function(){d.data("hover")||(d.hasClass("reverse")&&d.prepend(d.children("li:last-child")),d.removeClass("active changing reverse").css("height",""),d.children().removeClass("hover nohover"),d.removeData("clicked"),a(window).off("keydown",h))},"mouseleave"!==c.type||d.data("clicked")?0:b.hoverIntent)},j=function(b){var c=a(b.currentTarget);!c.hasClass("active")||new Date-c.data("lastKeypress")<200||(k(c.children(),0,1),k(a(b.target),1,1))},k=function(a,c,e){if(c){if(a.removeClass("nohover").addClass("hover"),1===a.length&&g&&!e){var f=a.parent(),h=f.outerHeight(),i=a.offset().top-f.offset().top-1;0===a.index()?f.scrollTop(0):a.index()===d?f.scrollTop(f.children().length*b.height):i+b.height>h?f.scrollTop(f.scrollTop()+b.height+i-h):i<0&&f.scrollTop(f.scrollTop()+i)}}else a.removeClass("hover").addClass("nohover")};return(isNaN(b.height)||b.height<8)&&(b.height=8),(isNaN(b.hoverIntent)||b.hoverIntent<0)&&(b.hoverIntent=200),this.each(function(){var c=a(this);if(c.data("loaded"))return!0;c.outerHeight(b.height);var d=c.outerWidth(),e="<ul"+(c.attr("title")?' title="'+c.attr("title")+'"':"")+' style="margin:'+c.css("margin-top")+" "+c.css("margin-right")+" "+c.css("margin-bottom")+" "+c.css("margin-left")+';">',f=function(a,c){return'<li data-value="'+a.value+'"'+(a.title?' title="'+a.title+'"':"")+(c?' class="'+c+'"':"")+(50!==b.height?' style="height:'+(b.height-2)+"px;line-height:"+(b.height-2)+'px"':"")+">"+a.text+"</li>"};c.children("option:selected").each(function(){e+=f(this,"selected")}),c.children("option:not(:selected)").each(function(){e+=f(this)}),e+="</ul>",c.css("visibility","hidden").wrap('<div class="prettydropdown '+b.customClass+' loading"></div>').before(e).data("loaded",!0);var k,g=c.parent().children("ul"),d=g.outerWidth(!0);if(g.width()<=0){var l=g.parent().clone().css({position:"absolute",top:"-100%"});a("body").append(l),d=l.children("ul").outerWidth(!0),k=l.children("ul").outerWidth(!0),l.remove()}g.children("li").click(function(){var d=a(this);if(g.hasClass("active")&&d.data("value")!==g.children("li.selected").data("value")&&(g.children("li.selected").removeClass("selected"),g.prepend(d.addClass("selected")).removeClass("reverse"),c.children('option[value="'+d.data("value")+'"]').prop("selected",!0),c.trigger("change")),g.toggleClass("active"),g.hasClass("active")){var e=window.innerHeight,f=g.offset().top,j=document.body.scrollTop,k=g.outerHeight(),l=f-j+k;l>e&&(f-j>e-(f-j+b.height)?(g.addClass("reverse").append(g.children("li.selected")),f-j+b.height<k&&(g.outerHeight(f-j+b.height),g.scrollTop(k))):g.height(g.height()-(l-e))),a(window).on("keydown",h)}else g.addClass("changing").data("clicked",!0),i(g[0])}),g.on({mouseenter:function(){g.data("hover",!0)},mouseleave:i,mousemove:j}),g.parent().removeClass("loading")})}}(jQuery);
